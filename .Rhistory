global_prediction <- apply(exp(as.matrix(b[,1])%*%
(forestry_sqrt_std-no_forestry))*100 - 100,2,median)
global_025 <- apply(exp(as.matrix(b[,1])%*%
(forestry_sqrt_std-no_forestry))*100 - 100,2,quantile,c(0.025),
row.names = c("q025"))
global_975 <- apply(exp(as.matrix(b[,1])%*%
(forestry_sqrt_std-no_forestry))*100 - 100,2,quantile,c(0.975),
row.names = c("q975"))
global_750 <- apply(exp(as.matrix(b[,1])%*%
(forestry_sqrt_std-no_forestry))*100 - 100,2,quantile,c(0.75),
row.names = c("q750"))
global_250 <- apply(exp(as.matrix(b[,1])%*%
(forestry_sqrt_std-no_forestry))*100 - 100,2,quantile,c(0.25),
row.names = c("q250"))
global_900 <- apply(exp(as.matrix(b[,1])%*%
(forestry_sqrt_std-no_forestry))*100 - 100,2,quantile,c(0.9),
row.names = c("q900"))
global_100 <- apply(exp(as.matrix(b[,1])%*%
(forestry_sqrt_std-no_forestry))*100 - 100,2,quantile,c(0.1),
row.names = c("q100"))
global_df <- data.frame(forestry = forestry,
productivity_median = global_prediction,
q025 = global_025,
q975 = global_975,
q750 = global_750,
q250 = global_250,
q900 = global_900,
q100 = global_100)
full_productivity <- NULL
if(by_river){
# no_forestry <- min(eca_std_sqrt)
for (i in 1:length(unique(df$River_n))){
river <- unique(df$River_n)[i]
river_data <- df %>% filter(River_n == river)
if(effect == "eca"){
b_rv <- posterior %>% select(starts_with("b_for_rv")) %>%
select(ends_with(paste0("[",river,"]")))
forestry_sqrt_std_river <- seq(min(river_data$sqrt.ECA.std),max(river_data$sqrt.ECA.std),length.out=100)
forestry_river <- seq(min(river_data$ECA_age_proxy_forested_only),max(river_data$ECA_age_proxy_forested_only),length.out=100)
} else if(effect == "cpd"){
b_rv <- posterior %>% select(starts_with("b_for_rv")) %>%
select(ends_with(paste0("[",river,"]")))
forestry_sqrt_std_river <- seq(min(river_data$sqrt.CPD.std),max(river_data$sqrt.CPD.std),length.out=100)
forestry_river <- seq(min(river_data$disturbedarea_prct_cs),max(river_data$disturbedarea_prct_cs),length.out=100)
} else if(effect == "sst"){
b_rv <- posterior %>% select(starts_with("b_sst_rv")) %>%
select(ends_with(paste0("[",river,"]")))
# use only spring_ersst
forestry_sqrt_std_river <- seq(min(river_data$sst.std),max(river_data$sst.std),length.out=100)
forestry_river <- seq(min(river_data$spring_ersst),max(river_data$spring_ersst),length.out=100)
}
productivity <- (exp(as.matrix(b_rv[,1])%*%
(forestry_sqrt_std-no_forestry)))*100 - 100
productivity_median <- apply(productivity,2,median)
productivity_median_df <- data.frame(River = unique(river_data$River),
productivity_median = productivity_median,
forestry = forestry_river) %>%
filter(forestry >= min(forestry_river), forestry <= max(forestry_river))
full_productivity <- rbind(full_productivity, productivity_median_df)
}
# b <- posterior %>% select(ends_with("b_for"))
median_prediction <- apply(exp(as.matrix(b[,1])%*%
(forestry_sqrt_std-no_forestry))*100 - 100,2,median)
median_df <- data.frame(forestry = forestry,
productivity_median = median_prediction)
if(effect == "eca" || effect == "cpd"){
p1 <- ggplot(full_productivity) +
geom_line(aes(x = forestry, y = productivity_median, group = River,
color = "watershed level\nforestry effect"),alpha=0.5) +
geom_line(data = global_df,
aes(x = forestry, y = productivity_median, color = "global forestry effect"), linewidth = 1) +
geom_ribbon(data = global_df, aes(x = forestry, ymin = q025, ymax = q975),
alpha = 0.5, fill = "#ADBCA5") +
# scale_fill_manual("",values  = c("95% credible interval" = "gray")) +
scale_color_manual("",values = c("watershed level\nforestry effect" = "darkgray",
"global forestry effect" = "black")) +
ylim(-100,100) +
scale_x_continuous(n.breaks = 5) +
labs(title = model,
x = ifelse(effect == "eca", "Equivalent clearcut area", "Cumulative percent disturbed (%)"),
y = "Median change\n in productivity (%)") +
theme_classic() +
theme(legend.position = c(0.8,0.8),
legend.title = element_blank(),
legend.key.size = unit(0.5, "cm"),
legend.key.width = unit(1, "cm"),
axis.title.x = element_text(size = 8),
axis.title.y = element_text(size = 8),
axis.text.x = element_text(size = 8),
axis.text.y = element_text(size = 8),
plot.title = element_text(size = 10, hjust = 0.5))+
guides(color = guide_legend(override.aes = list(alpha = 1, linewidth = 1.5)))
} else if(effect == "sst"){
p1 <- ggplot(full_productivity) +
geom_line(aes(x = forestry, y = productivity_median, group = River,
color = "watershed level\nSST effect"),alpha=0.5) +
geom_line(data = global_df,
aes(x = forestry, y = productivity_median, color = "global SST effect"), linewidth = 1) +
geom_ribbon(data = global_df, aes(x = forestry, ymin = q025, ymax = q975),
alpha = 0.5, fill = "gray") +
# scale_fill_manual("",values  = c("95% credible interval" = "gray")) +
scale_color_manual("",values = c("watershed level\nSST effect" = "darkgray",
"global SST effect" = "black")) +
ylim(-100,100) +
scale_x_continuous(n.breaks = 5, limits = c(10,15)) +
labs(title = model,
x = "Spring SST (°C)",
y = "Median change\n in productivity (%)") +
theme_classic() +
theme(legend.position = c(0.8,0.8),
legend.title = element_blank(),
legend.key.size = unit(0.5, "cm"),
legend.key.width = unit(1, "cm"),
axis.title.x = element_text(size = 8),
axis.title.y = element_text(size = 8),
axis.text.x = element_text(size = 8),
axis.text.y = element_text(size = 8),
plot.title = element_text(size = 10, hjust = 0.5))+
guides(color = guide_legend(override.aes = list(alpha = 1, linewidth = 1.5)))
}
} else {
if(effect == "eca" || effect == "cpd"){
p1 <- ggplot(full_productivity) +
# geom_line(aes(x = forestry, y = productivity_median, group = River,
#               color = "watershed level\nforestry effect"),alpha=0.5) +
geom_line(data = global_df,
aes(x = forestry, y = productivity_median, color = "global forestry effect"), linewidth = 1) +
geom_ribbon(data = global_df, aes(x = forestry, ymin = q025, ymax = q975),
alpha = 0.25, fill = "#ADBCA5") +
geom_ribbon(data = global_df, aes(x = forestry, ymin = q250, ymax = q750),
alpha = 0.65, fill = "#ADBCA5") +
geom_ribbon(data = global_df, aes(x = forestry, ymin = q100, ymax = q900),
alpha = 0.45, fill = "#ADBCA5") +
# scale_fill_manual("",values  = c("95% credible interval" = "gray")) +
scale_color_manual("",values = c("global forestry effect" = "#6F7B67")) +
ylim(-100,50) +
scale_x_continuous(n.breaks = 5) +
labs(title = model,
x = ifelse(effect == "eca", "Equivalent clearcut area", "Cumulative percent disturbed (%)"),
y = "Median change\n in productivity (%)") +
theme_classic() +
theme(legend.position = "none",
legend.title = element_blank(),
legend.key.size = unit(0.5, "cm"),
legend.key.width = unit(1, "cm"),
axis.title.x = element_text(size = 8),
axis.title.y = element_text(size = 8),
axis.text.x = element_text(size = 8),
axis.text.y = element_text(size = 8),
plot.title = element_text(size = 10, hjust = 0.5))+
guides(color = guide_legend(override.aes = list(alpha = 1, linewidth = 1.5)))
} else if(effect == "sst"){
p1 <- ggplot(full_productivity) +
# geom_line(aes(x = forestry, y = productivity_median, group = River,
#               color = "watershed level\nSST effect"),alpha=0.5) +
geom_line(data = global_df,
aes(x = forestry, y = productivity_median, color = "global SST effect"), linewidth = 1) +
geom_ribbon(data = global_df, aes(x = forestry, ymin = q025, ymax = q975),
alpha = 0.25, fill = "#C78B63") +
geom_ribbon(data = global_df, aes(x = forestry, ymin = q250, ymax = q750),
alpha = 0.65, fill = "#C78B63") +
geom_ribbon(data = global_df, aes(x = forestry, ymin = q100, ymax = q900),
alpha = 0.45, fill = "#C78B63") +
# scale_fill_manual("",values  = c("95% credible interval" = "gray")) +
scale_color_manual("",values = c("global SST effect" = "#C78B63")) +
ylim(-50,100) +
scale_x_continuous(n.breaks = 5, limits = c(10,15)) +
labs(title = model,
x = "Spring SST (°C)",
y = "Median change\n in productivity (%)") +
theme_classic() +
theme(legend.position = "none",
legend.title = element_blank(),
legend.key.size = unit(0.5, "cm"),
legend.key.width = unit(1, "cm"),
axis.title.x = element_text(size = 8),
axis.title.y = element_text(size = 8),
axis.text.x = element_text(size = 8),
axis.text.y = element_text(size = 8),
plot.title = element_text(size = 10, hjust = 0.5))+
guides(color = guide_legend(override.aes = list(alpha = 1, linewidth = 1.5)))
}else if(effect == "npgo"){
p1 <- ggplot(full_productivity) +
# geom_line(aes(x = forestry, y = productivity_median, group = River,
#               color = "watershed level\nSST effect"),alpha=0.5) +
geom_line(data = global_df,
aes(x = forestry, y = productivity_median, color = "global NPGO effect"), linewidth = 1) +
geom_ribbon(data = global_df, aes(x = forestry, ymin = q025, ymax = q975),
alpha = 0.25, fill = "#829DB6") +
geom_ribbon(data = global_df, aes(x = forestry, ymin = q250, ymax = q750),
alpha = 0.65, fill = "#829DB6") +
geom_ribbon(data = global_df, aes(x = forestry, ymin = q100, ymax = q900),
alpha = 0.45, fill = "#829DB6") +
# scale_fill_manual("",values  = c("95% credible interval" = "gray")) +
scale_color_manual("",values = c("global NPGO effect" = "#829DB6")) +
ylim(-50,100) +
scale_x_continuous(n.breaks = 5, limits = c(-3,3)) +
labs(title = model,
x = "NPGO",
y = "Median change\n in productivity (%)") +
theme_classic() +
theme(legend.position = "none",
legend.title = element_blank(),
legend.key.size = unit(0.5, "cm"),
legend.key.width = unit(1, "cm"),
axis.title.x = element_text(size = 8),
axis.title.y = element_text(size = 8),
axis.text.x = element_text(size = 8),
axis.text.y = element_text(size = 8),
plot.title = element_text(size = 10, hjust = 0.5))+
guides(color = guide_legend(override.aes = list(alpha = 1, linewidth = 1.5)))
}
}
return(p1)
}
(plot_forestry_effect_manuscript(posterior = ric_pk_cpd_ersst,
effect = "cpd", species = "pink",
model = "Ricker model with CPD", xlim = c(-1.3, 1.3))/
plot_forestry_effect_manuscript(posterior = ric_pk_eca_ersst,
effect = "eca", species = "pink",
model = "Ricker model with ECA", xlim = c(-1.3, 1.3))/
plot_sst_effect_manuscript(posterior = ric_pk_cpd_ersst,
effect = "sst", species = "pink",
model = "Ricker model with CPD",
xlim = c(-1.3, 1.3))/
plot_npgo_effect_manuscript(posterior = ric_pk_cpd_ersst,
effect = "npgo", species = "pink",
model = "Ricker model with CPD",
xlim = c(-1.3, 1.3))/
plot_forestry_effect_manuscript(posterior = bh_pk_cpd_ersst,
effect = "cpd", species = "pink",
model = "BH model with CPD", xlim = c(-1.3, 1.3))/
plot_forestry_effect_manuscript(posterior = bh_pk_eca_ersst,
effect = "eca", species = "pink",
model = "BH model with ECA", xlim = c(-1.3, 1.3))/
plot_sst_effect_manuscript(posterior = bh_pk_cpd_ersst,
effect = "sst", species = "pink",
model = "BH model with CPD",
xlim = c(-1.3, 1.3))/
plot_npgo_effect_manuscript(posterior = bh_pk_cpd_ersst,
effect = "npgo", species = "pink",
model = "BH model with CPD",
xlim = c(-1.3, 1.3))+ plot_layout(axes = 'collect') |
(((plot_productivity_decline_manuscript(posterior = ric_pk_cpd_ersst,
species = "pink",
effect = "cpd", model = "Ricker model with CPD")+
plot_productivity_decline_manuscript(posterior = ric_pk_eca_ersst,
species = "pink",
effect = "eca", model = "Ricker model with ECA")) + plot_layout(axes = 'collect'))/
((plot_productivity_decline_manuscript(posterior = ric_pk_cpd_ersst,
species = "pink",
effect = "sst", model = "Ricker model with CPD")+
plot_productivity_decline_manuscript(posterior = ric_pk_cpd_ersst,
species = "pink",
effect = "npgo", model = "Ricker model with CPD")) + plot_layout(axes = 'collect'))/
((plot_productivity_decline_manuscript(posterior = bh_pk_cpd_ersst,
species = "pink",
effect = "cpd", model = "BH model with CPD")+
plot_productivity_decline_manuscript(posterior = bh_pk_eca_ersst,
species = "pink",
effect = "eca", model = "BH model with ECA")) + plot_layout(axes = 'collect'))/
((plot_productivity_decline_manuscript(posterior = bh_pk_cpd_ersst,
species = "pink",
effect = "sst", model = "BH model with CPD")+
plot_productivity_decline_manuscript(posterior = bh_pk_cpd_ersst,
species = "pink",
effect = "npgo", model = "BH model with CPD")) + plot_layout(axes = 'collect'))
)
)
ggsave(here("figures","manuscript_aug2025_pink_results.png"), width = 10, height = 12)
ggsave(here("figures","manuscript_aug2025_pink_results.png"), width = 10, height = 12)
(plot_forestry_effect_manuscript(posterior = ric_pk_cpd_ersst,
effect = "cpd", species = "pink",
model = "Ricker model with CPD", xlim = c(-1.3, 1.3))/
plot_forestry_effect_manuscript(posterior = ric_pk_eca_ersst,
effect = "eca", species = "pink",
model = "Ricker model with ECA", xlim = c(-1.3, 1.3))/
plot_sst_effect_manuscript(posterior = ric_pk_cpd_ersst,
effect = "sst", species = "pink",
model = "Ricker model with CPD",
xlim = c(-1.3, 1.3))/
plot_npgo_effect_manuscript(posterior = ric_pk_cpd_ersst,
effect = "npgo", species = "pink",
model = "Ricker model with CPD",
xlim = c(-1.3, 1.3))/
plot_forestry_effect_manuscript(posterior = bh_pk_cpd_ersst,
effect = "cpd", species = "pink",
model = "BH model with CPD", xlim = c(-1.3, 1.3))/
plot_forestry_effect_manuscript(posterior = bh_pk_eca_ersst,
effect = "eca", species = "pink",
model = "BH model with ECA", xlim = c(-1.3, 1.3))/
plot_sst_effect_manuscript(posterior = bh_pk_cpd_ersst,
effect = "sst", species = "pink",
model = "BH model with CPD",
xlim = c(-1.3, 1.3))/
plot_npgo_effect_manuscript(posterior = bh_pk_cpd_ersst,
effect = "npgo", species = "pink",
model = "BH model with CPD",
xlim = c(-1.3, 1.3))+ plot_layout(axes = 'collect')|
(((plot_productivity_decline_manuscript(posterior = ric_pk_cpd_ersst,
species = "pink",
effect = "cpd", model = "Ricker model with CPD")+
plot_productivity_decline_manuscript(posterior = ric_pk_eca_ersst,
species = "pink",
effect = "eca", model = "Ricker model with ECA")) + plot_layout(axes = 'collect'))/
((plot_productivity_decline_manuscript(posterior = ric_pk_cpd_ersst,
species = "pink",
effect = "sst", model = "Ricker model with CPD")+
plot_productivity_decline_manuscript(posterior = ric_pk_cpd_ersst,
species = "pink",
effect = "npgo", model = "Ricker model with CPD")) + plot_layout(axes = 'collect'))/
((plot_productivity_decline_manuscript(posterior = bh_pk_cpd_ersst,
species = "pink",
effect = "cpd", model = "BH model with CPD")+
plot_productivity_decline_manuscript(posterior = bh_pk_eca_ersst,
species = "pink",
effect = "eca", model = "BH model with ECA")) + plot_layout(axes = 'collect'))/
((plot_productivity_decline_manuscript(posterior = bh_pk_cpd_ersst,
species = "pink",
effect = "sst", model = "BH model with CPD")+
plot_productivity_decline_manuscript(posterior = bh_pk_cpd_ersst,
species = "pink",
effect = "npgo", model = "BH model with CPD")) + plot_layout(axes = 'collect'))
) + plot_annotation(tag_levels = 'a')
)
(((plot_productivity_decline_manuscript(posterior = ric_pk_cpd_ersst,
species = "pink",
effect = "cpd", model = "Ricker model with CPD")+
plot_productivity_decline_manuscript(posterior = ric_pk_eca_ersst,
species = "pink",
effect = "eca", model = "Ricker model with ECA")) + plot_layout(axes = 'collect'))/
((plot_productivity_decline_manuscript(posterior = ric_pk_cpd_ersst,
species = "pink",
effect = "sst", model = "Ricker model with CPD")+
plot_productivity_decline_manuscript(posterior = ric_pk_cpd_ersst,
species = "pink",
effect = "npgo", model = "Ricker model with CPD")) + plot_layout(axes = 'collect'))/
((plot_productivity_decline_manuscript(posterior = bh_pk_cpd_ersst,
species = "pink",
effect = "cpd", model = "BH model with CPD")+
plot_productivity_decline_manuscript(posterior = bh_pk_eca_ersst,
species = "pink",
effect = "eca", model = "BH model with ECA")) + plot_layout(axes = 'collect'))/
((plot_productivity_decline_manuscript(posterior = bh_pk_cpd_ersst,
species = "pink",
effect = "sst", model = "BH model with CPD")+
plot_productivity_decline_manuscript(posterior = bh_pk_cpd_ersst,
species = "pink",
effect = "npgo", model = "BH model with CPD")) + plot_layout(axes = 'collect'))
) + plot_annotation(tag_levels = 'a')
(plot_forestry_effect_manuscript(posterior = ric_pk_cpd_ersst,
effect = "cpd", species = "pink",
model = "Ricker model with CPD", xlim = c(-1.3, 1.3))/
plot_forestry_effect_manuscript(posterior = ric_pk_eca_ersst,
effect = "eca", species = "pink",
model = "Ricker model with ECA", xlim = c(-1.3, 1.3))/
plot_sst_effect_manuscript(posterior = ric_pk_cpd_ersst,
effect = "sst", species = "pink",
model = "Ricker model with CPD",
xlim = c(-1.3, 1.3))/
plot_npgo_effect_manuscript(posterior = ric_pk_cpd_ersst,
effect = "npgo", species = "pink",
model = "Ricker model with CPD",
xlim = c(-1.3, 1.3))/
plot_forestry_effect_manuscript(posterior = bh_pk_cpd_ersst,
effect = "cpd", species = "pink",
model = "BH model with CPD", xlim = c(-1.3, 1.3))/
plot_forestry_effect_manuscript(posterior = bh_pk_eca_ersst,
effect = "eca", species = "pink",
model = "BH model with ECA", xlim = c(-1.3, 1.3))/
plot_sst_effect_manuscript(posterior = bh_pk_cpd_ersst,
effect = "sst", species = "pink",
model = "BH model with CPD",
xlim = c(-1.3, 1.3))/
plot_npgo_effect_manuscript(posterior = bh_pk_cpd_ersst,
effect = "npgo", species = "pink",
model = "BH model with CPD",
xlim = c(-1.3, 1.3))+ plot_layout(axes = 'collect')) + plot_annotation(tag_levels = 'a')|
(((plot_productivity_decline_manuscript(posterior = ric_pk_cpd_ersst,
species = "pink",
effect = "cpd", model = "Ricker model with CPD")+
plot_productivity_decline_manuscript(posterior = ric_pk_eca_ersst,
species = "pink",
effect = "eca", model = "Ricker model with ECA")) + plot_layout(axes = 'collect'))/
((plot_productivity_decline_manuscript(posterior = ric_pk_cpd_ersst,
species = "pink",
effect = "sst", model = "Ricker model with CPD")+
plot_productivity_decline_manuscript(posterior = ric_pk_cpd_ersst,
species = "pink",
effect = "npgo", model = "Ricker model with CPD")) + plot_layout(axes = 'collect'))/
((plot_productivity_decline_manuscript(posterior = bh_pk_cpd_ersst,
species = "pink",
effect = "cpd", model = "BH model with CPD")+
plot_productivity_decline_manuscript(posterior = bh_pk_eca_ersst,
species = "pink",
effect = "eca", model = "BH model with ECA")) + plot_layout(axes = 'collect'))/
((plot_productivity_decline_manuscript(posterior = bh_pk_cpd_ersst,
species = "pink",
effect = "sst", model = "BH model with CPD")+
plot_productivity_decline_manuscript(posterior = bh_pk_cpd_ersst,
species = "pink",
effect = "npgo", model = "BH model with CPD")) + plot_layout(axes = 'collect'))
)
(plot_forestry_effect_manuscript(posterior = ric_pk_cpd_ersst,
effect = "cpd", species = "pink",
model = "Ricker model with CPD", xlim = c(-1.3, 1.3))/
plot_forestry_effect_manuscript(posterior = ric_pk_eca_ersst,
effect = "eca", species = "pink",
model = "Ricker model with ECA", xlim = c(-1.3, 1.3))/
plot_sst_effect_manuscript(posterior = ric_pk_cpd_ersst,
effect = "sst", species = "pink",
model = "Ricker model with CPD",
xlim = c(-1.3, 1.3))/
plot_npgo_effect_manuscript(posterior = ric_pk_cpd_ersst,
effect = "npgo", species = "pink",
model = "Ricker model with CPD",
xlim = c(-1.3, 1.3))/
plot_forestry_effect_manuscript(posterior = bh_pk_cpd_ersst,
effect = "cpd", species = "pink",
model = "BH model with CPD", xlim = c(-1.3, 1.3))/
plot_forestry_effect_manuscript(posterior = bh_pk_eca_ersst,
effect = "eca", species = "pink",
model = "BH model with ECA", xlim = c(-1.3, 1.3))/
plot_sst_effect_manuscript(posterior = bh_pk_cpd_ersst,
effect = "sst", species = "pink",
model = "BH model with CPD",
xlim = c(-1.3, 1.3))/
plot_npgo_effect_manuscript(posterior = bh_pk_cpd_ersst,
effect = "npgo", species = "pink",
model = "BH model with CPD",
xlim = c(-1.3, 1.3))+ plot_layout(axes = 'collect'))|
(((plot_productivity_decline_manuscript(posterior = ric_pk_cpd_ersst,
species = "pink",
effect = "cpd", model = "Ricker model with CPD")+
plot_productivity_decline_manuscript(posterior = ric_pk_eca_ersst,
species = "pink",
effect = "eca", model = "Ricker model with ECA")) + plot_layout(axes = 'collect'))/
((plot_productivity_decline_manuscript(posterior = ric_pk_cpd_ersst,
species = "pink",
effect = "sst", model = "Ricker model with CPD")+
plot_productivity_decline_manuscript(posterior = ric_pk_cpd_ersst,
species = "pink",
effect = "npgo", model = "Ricker model with CPD")) + plot_layout(axes = 'collect'))/
((plot_productivity_decline_manuscript(posterior = bh_pk_cpd_ersst,
species = "pink",
effect = "cpd", model = "BH model with CPD")+
plot_productivity_decline_manuscript(posterior = bh_pk_eca_ersst,
species = "pink",
effect = "eca", model = "BH model with ECA")) + plot_layout(axes = 'collect'))/
((plot_productivity_decline_manuscript(posterior = bh_pk_cpd_ersst,
species = "pink",
effect = "sst", model = "BH model with CPD")+
plot_productivity_decline_manuscript(posterior = bh_pk_cpd_ersst,
species = "pink",
effect = "npgo", model = "BH model with CPD")) + plot_layout(axes = 'collect'))
)
(plot_forestry_effect_manuscript(posterior = ric_pk_cpd_ersst,
effect = "cpd", species = "pink",
model = "Ricker model with CPD", xlim = c(-1.3, 1.3))/
plot_forestry_effect_manuscript(posterior = ric_pk_eca_ersst,
effect = "eca", species = "pink",
model = "Ricker model with ECA", xlim = c(-1.3, 1.3))/
plot_sst_effect_manuscript(posterior = ric_pk_cpd_ersst,
effect = "sst", species = "pink",
model = "Ricker model with CPD",
xlim = c(-1.3, 1.3))/
plot_npgo_effect_manuscript(posterior = ric_pk_cpd_ersst,
effect = "npgo", species = "pink",
model = "Ricker model with CPD",
xlim = c(-1.3, 1.3))/
plot_forestry_effect_manuscript(posterior = bh_pk_cpd_ersst,
effect = "cpd", species = "pink",
model = "BH model with CPD", xlim = c(-1.3, 1.3))/
plot_forestry_effect_manuscript(posterior = bh_pk_eca_ersst,
effect = "eca", species = "pink",
model = "BH model with ECA", xlim = c(-1.3, 1.3))/
plot_sst_effect_manuscript(posterior = bh_pk_cpd_ersst,
effect = "sst", species = "pink",
model = "BH model with CPD",
xlim = c(-1.3, 1.3))/
plot_npgo_effect_manuscript(posterior = bh_pk_cpd_ersst,
effect = "npgo", species = "pink",
model = "BH model with CPD",
xlim = c(-1.3, 1.3))+ plot_layout(axes = 'collect'))|
(((plot_productivity_decline_manuscript(posterior = ric_pk_cpd_ersst,
species = "pink",
effect = "cpd", model = "Ricker model with CPD")+
plot_productivity_decline_manuscript(posterior = ric_pk_eca_ersst,
species = "pink",
effect = "eca", model = "Ricker model with ECA")) + plot_layout(axes = 'collect'))/
((plot_productivity_decline_manuscript(posterior = ric_pk_cpd_ersst,
species = "pink",
effect = "sst", model = "Ricker model with CPD")+
plot_productivity_decline_manuscript(posterior = ric_pk_cpd_ersst,
species = "pink",
effect = "npgo", model = "Ricker model with CPD")) + plot_layout(axes = 'collect'))/
((plot_productivity_decline_manuscript(posterior = bh_pk_cpd_ersst,
species = "pink",
effect = "cpd", model = "BH model with CPD")+
plot_productivity_decline_manuscript(posterior = bh_pk_eca_ersst,
species = "pink",
effect = "eca", model = "BH model with ECA")) + plot_layout(axes = 'collect'))/
((plot_productivity_decline_manuscript(posterior = bh_pk_cpd_ersst,
species = "pink",
effect = "sst", model = "BH model with CPD")+
plot_productivity_decline_manuscript(posterior = bh_pk_cpd_ersst,
species = "pink",
effect = "npgo", model = "BH model with CPD")) + plot_layout(axes = 'collect'))
)
plot_forestry_effect_manuscript(posterior = ric_pk_cpd_ersst,
effect = "cpd", species = "pink",
model = "Ricker model with CPD", xlim = c(-1.3, 1.3))
