df <- pk10r
}
effect_df <- NULL
for (i in 1:length(unique(df$CU_n))){
cu <- unique(df$CU_n)[i]
cu_data <- df %>% filter(CU_n == cu)
if(effect == "cpd"){
b_cu <- posterior %>% select(starts_with("b_for_cu")) %>%
select(ends_with(paste0("[",cu,"]")))
} else if(effect == "sst"){
b_cu <- posterior %>% select(starts_with("b_sst_cu")) %>%
select(ends_with(paste0("[",cu,"]")))
} else if(effect == "npgo"){
b_cu <- posterior %>% select(starts_with("b_npgo_cu")) %>%
select(ends_with(paste0("[",cu,"]")))
}
effect_df_cu <- data.frame(CU = unique(cu_data$CU_name),
effect_median = round(apply(as.matrix(b_cu[,1]),2,median)),2)
# sym(effect)_25 = apply(as.matrix(b_cu[,1]),2,quantile, probs = 0.25),
# sym(effect)_75 = apply(as.matrix(b_cu[,1]),2,quantile, probs = 0.75),
# sym(effect)_025 = apply(as.matrix(b_cu[,1]),2,quantile, probs = 0.025),
# sym(effect)_975 = apply(as.matrix(b_cu[,1]),2,quantile, probs = 0.975))
effect_df <- rbind(effect_df, effect_df_cu)
}
return(effect_df)
}
effect_chum_cpd_sst_npgo <- effect_sizes_cu_df(ric_chm_cpd_ocean_covariates_logR, effect = "cpd", species = "chum") %>%
rename(cpd_effect_median = effect_median) %>%
left_join(effect_sizes_cu_df(ric_chm_cpd_ocean_covariates_logR, effect = "sst", species = "chum") %>%
rename(sst_effect_median = effect_median), by = "CU") %>%
left_join(effect_sizes_cu_df(ric_chm_cpd_ocean_covariates_logR, effect = "npgo", species = "chum") %>%
rename(npgo_effect_median = effect_median), by = "CU")
round(apply(as.matrix(b_cu[,1]),2,median)),2)
effect_chum_cpd_sst_npgo <- effect_sizes_cu_df(ric_chm_cpd_ocean_covariates_logR, effect = "cpd", species = "chum") %>%
rename(cpd_effect_median = effect_median) %>%
left_join(effect_sizes_cu_df(ric_chm_cpd_ocean_covariates_logR, effect = "sst", species = "chum") %>%
rename(sst_effect_median = effect_median), by = "CU") %>%
left_join(effect_sizes_cu_df(ric_chm_cpd_ocean_covariates_logR, effect = "npgo", species = "chum") %>%
rename(npgo_effect_median = effect_median), by = "CU") %>%
round(2)
effect_chum_cpd_sst_npgo <- effect_sizes_cu_df(ric_chm_cpd_ocean_covariates_logR, effect = "cpd", species = "chum") %>%
rename(cpd_effect_median = effect_median) %>%
left_join(effect_sizes_cu_df(ric_chm_cpd_ocean_covariates_logR, effect = "sst", species = "chum") %>%
rename(sst_effect_median = effect_median), by = "CU") %>%
left_join(effect_sizes_cu_df(ric_chm_cpd_ocean_covariates_logR, effect = "npgo", species = "chum") %>%
rename(npgo_effect_median = effect_median), by = "CU") %>%
apply(-c("CU"), round, 2)
effect_chum_cpd_sst_npgo <- effect_sizes_cu_df(ric_chm_cpd_ocean_covariates_logR, effect = "cpd", species = "chum") %>%
rename(cpd_effect_median = effect_median) %>%
left_join(effect_sizes_cu_df(ric_chm_cpd_ocean_covariates_logR, effect = "sst", species = "chum") %>%
rename(sst_effect_median = effect_median), by = "CU") %>%
left_join(effect_sizes_cu_df(ric_chm_cpd_ocean_covariates_logR, effect = "npgo", species = "chum") %>%
rename(npgo_effect_median = effect_median), by = "CU") %>%
apply(-"CU", round, 2)
effect_chum_cpd_sst_npgo <- effect_sizes_cu_df(ric_chm_cpd_ocean_covariates_logR, effect = "cpd", species = "chum") %>%
rename(cpd_effect_median = effect_median) %>%
left_join(effect_sizes_cu_df(ric_chm_cpd_ocean_covariates_logR, effect = "sst", species = "chum") %>%
rename(sst_effect_median = effect_median), by = "CU") %>%
left_join(effect_sizes_cu_df(ric_chm_cpd_ocean_covariates_logR, effect = "npgo", species = "chum") %>%
rename(npgo_effect_median = effect_median), by = "CU") %>%
apply(., round, 2)
effect_chum_cpd_sst_npgo <- effect_sizes_cu_df(ric_chm_cpd_ocean_covariates_logR, effect = "cpd", species = "chum") %>%
rename(cpd_effect_median = effect_median) %>%
left_join(effect_sizes_cu_df(ric_chm_cpd_ocean_covariates_logR, effect = "sst", species = "chum") %>%
rename(sst_effect_median = effect_median), by = "CU") %>%
left_join(effect_sizes_cu_df(ric_chm_cpd_ocean_covariates_logR, effect = "npgo", species = "chum") %>%
rename(npgo_effect_median = effect_median), by = "CU") %>%
apply(., round(), 2)
effect_chum_cpd_sst_npgo <- effect_sizes_cu_df(ric_chm_cpd_ocean_covariates_logR, effect = "cpd", species = "chum") %>%
rename(cpd_effect_median = effect_median) %>%
left_join(effect_sizes_cu_df(ric_chm_cpd_ocean_covariates_logR, effect = "sst", species = "chum") %>%
rename(sst_effect_median = effect_median), by = "CU") %>%
left_join(effect_sizes_cu_df(ric_chm_cpd_ocean_covariates_logR, effect = "npgo", species = "chum") %>%
rename(npgo_effect_median = effect_median), by = "CU") %>%
#round to 2
mutate(across(where(is.numeric), ~round(., 2)))
effect_chum_cpd_sst_npgo <- effect_sizes_cu_df(ric_chm_cpd_ocean_covariates_logR, effect = "cpd", species = "chum") %>%
rename(cpd_effect_median = effect_median) %>%
left_join(effect_sizes_cu_df(ric_chm_cpd_ocean_covariates_logR, effect = "sst", species = "chum") %>%
rename(sst_effect_median = effect_median), by = "CU") %>%
left_join(effect_sizes_cu_df(ric_chm_cpd_ocean_covariates_logR, effect = "npgo", species = "chum") %>%
rename(npgo_effect_median = effect_median), by = "CU")
effect_sizes_cu_df <- function(posterior, effect, species){
if(species == "chum"){
df <- ch20rsc
} else if(species == "pink"){
df <- pk10r
}
effect_df <- NULL
for (i in 1:length(unique(df$CU_n))){
cu <- unique(df$CU_n)[i]
cu_data <- df %>% filter(CU_n == cu)
if(effect == "cpd"){
b_cu <- posterior %>% select(starts_with("b_for_cu")) %>%
select(ends_with(paste0("[",cu,"]")))
} else if(effect == "sst"){
b_cu <- posterior %>% select(starts_with("b_sst_cu")) %>%
select(ends_with(paste0("[",cu,"]")))
} else if(effect == "npgo"){
b_cu <- posterior %>% select(starts_with("b_npgo_cu")) %>%
select(ends_with(paste0("[",cu,"]")))
}
effect_df_cu <- data.frame(CU = unique(cu_data$CU_name),
effect_median = apply(as.matrix(b_cu[,1]),2,median))
# sym(effect)_25 = apply(as.matrix(b_cu[,1]),2,quantile, probs = 0.25),
# sym(effect)_75 = apply(as.matrix(b_cu[,1]),2,quantile, probs = 0.75),
# sym(effect)_025 = apply(as.matrix(b_cu[,1]),2,quantile, probs = 0.025),
# sym(effect)_975 = apply(as.matrix(b_cu[,1]),2,quantile, probs = 0.975))
effect_df <- rbind(effect_df, effect_df_cu)
}
return(effect_df)
}
effect_chum_cpd_sst_npgo <- effect_sizes_cu_df(ric_chm_cpd_ocean_covariates_logR, effect = "cpd", species = "chum") %>%
rename(cpd_effect_median = effect_median) %>%
left_join(effect_sizes_cu_df(ric_chm_cpd_ocean_covariates_logR, effect = "sst", species = "chum") %>%
rename(sst_effect_median = effect_median), by = "CU") %>%
left_join(effect_sizes_cu_df(ric_chm_cpd_ocean_covariates_logR, effect = "npgo", species = "chum") %>%
rename(npgo_effect_median = effect_median), by = "CU")
effect_chum_cpd_sst_npgo <- effect_sizes_cu_df(ric_chm_cpd_ocean_covariates_logR, effect = "cpd", species = "chum") %>%
rename(cpd_effect_median = effect_median) %>%
left_join(effect_sizes_cu_df(ric_chm_cpd_ocean_covariates_logR, effect = "sst", species = "chum") %>%
rename(sst_effect_median = effect_median), by = "CU") %>%
left_join(effect_sizes_cu_df(ric_chm_cpd_ocean_covariates_logR, effect = "npgo", species = "chum") %>%
rename(npgo_effect_median = effect_median), by = "CU") %>%
across
effect_chum_cpd_sst_npgo <- effect_sizes_cu_df(ric_chm_cpd_ocean_covariates_logR, effect = "cpd", species = "chum") %>%
rename(cpd_effect_median = effect_median) %>%
left_join(effect_sizes_cu_df(ric_chm_cpd_ocean_covariates_logR, effect = "sst", species = "chum") %>%
rename(sst_effect_median = effect_median), by = "CU") %>%
left_join(effect_sizes_cu_df(ric_chm_cpd_ocean_covariates_logR, effect = "npgo", species = "chum") %>%
rename(npgo_effect_median = effect_median), by = "CU") %>%
across(where(is.numeric()), round, 3)
effect_chum_cpd_sst_npgo <- effect_sizes_cu_df(ric_chm_cpd_ocean_covariates_logR, effect = "cpd", species = "chum") %>%
rename(cpd_effect_median = effect_median) %>%
left_join(effect_sizes_cu_df(ric_chm_cpd_ocean_covariates_logR, effect = "sst", species = "chum") %>%
rename(sst_effect_median = effect_median), by = "CU") %>%
left_join(effect_sizes_cu_df(ric_chm_cpd_ocean_covariates_logR, effect = "npgo", species = "chum") %>%
rename(npgo_effect_median = effect_median), by = "CU") %>%
mutate(across(where(is.numeric()), round, 2))
effect_chum_cpd_sst_npgo <- effect_sizes_cu_df(ric_chm_cpd_ocean_covariates_logR, effect = "cpd", species = "chum") %>%
rename(cpd_effect_median = effect_median) %>%
left_join(effect_sizes_cu_df(ric_chm_cpd_ocean_covariates_logR, effect = "sst", species = "chum") %>%
rename(sst_effect_median = effect_median), by = "CU") %>%
left_join(effect_sizes_cu_df(ric_chm_cpd_ocean_covariates_logR, effect = "npgo", species = "chum") %>%
rename(npgo_effect_median = effect_median), by = "CU")
apply(as.matrix(b_cu[,1]),2,median))
apply(as.matrix(b_cu[,1]),2,median)
i=1
cu <- unique(df$CU_n)[i]
cu_data <- df %>% filter(CU_n == cu)
if(effect == "cpd"){
b_cu <- posterior %>% select(starts_with("b_for_cu")) %>%
select(ends_with(paste0("[",cu,"]")))
} else if(effect == "sst"){
b_cu <- posterior %>% select(starts_with("b_sst_cu")) %>%
select(ends_with(paste0("[",cu,"]")))
} else if(effect == "npgo"){
b_cu <- posterior %>% select(starts_with("b_npgo_cu")) %>%
select(ends_with(paste0("[",cu,"]")))
}
apply(as.matrix(b_cu[,1]),2,median)
posteror = ric_chm_cpd_ocean_covariates_logR
posterior = ric_chm_cpd_ocean_covariates_logR
if(effect == "cpd"){
b_cu <- posterior %>% select(starts_with("b_for_cu")) %>%
select(ends_with(paste0("[",cu,"]")))
} else if(effect == "sst"){
b_cu <- posterior %>% select(starts_with("b_sst_cu")) %>%
select(ends_with(paste0("[",cu,"]")))
} else if(effect == "npgo"){
b_cu <- posterior %>% select(starts_with("b_npgo_cu")) %>%
select(ends_with(paste0("[",cu,"]")))
}
apply(as.matrix(b_cu[,1]),2,median)
round(apply(as.matrix(b_cu[,1]),2,median),2)
effect_sizes_cu_df <- function(posterior, effect, species){
if(species == "chum"){
df <- ch20rsc
} else if(species == "pink"){
df <- pk10r
}
effect_df <- NULL
for (i in 1:length(unique(df$CU_n))){
cu <- unique(df$CU_n)[i]
cu_data <- df %>% filter(CU_n == cu)
if(effect == "cpd"){
b_cu <- posterior %>% select(starts_with("b_for_cu")) %>%
select(ends_with(paste0("[",cu,"]")))
} else if(effect == "sst"){
b_cu <- posterior %>% select(starts_with("b_sst_cu")) %>%
select(ends_with(paste0("[",cu,"]")))
} else if(effect == "npgo"){
b_cu <- posterior %>% select(starts_with("b_npgo_cu")) %>%
select(ends_with(paste0("[",cu,"]")))
}
effect_df_cu <- data.frame(CU = unique(cu_data$CU_name),
effect_median = round(apply(as.matrix(b_cu[,1]),2,median),2))
# sym(effect)_25 = apply(as.matrix(b_cu[,1]),2,quantile, probs = 0.25),
# sym(effect)_75 = apply(as.matrix(b_cu[,1]),2,quantile, probs = 0.75),
# sym(effect)_025 = apply(as.matrix(b_cu[,1]),2,quantile, probs = 0.025),
# sym(effect)_975 = apply(as.matrix(b_cu[,1]),2,quantile, probs = 0.975))
effect_df <- rbind(effect_df, effect_df_cu)
}
return(effect_df)
}
effect_chum_cpd_sst_npgo <- effect_sizes_cu_df(ric_chm_cpd_ocean_covariates_logR, effect = "cpd", species = "chum") %>%
rename(cpd_effect_median = effect_median) %>%
left_join(effect_sizes_cu_df(ric_chm_cpd_ocean_covariates_logR, effect = "sst", species = "chum") %>%
rename(sst_effect_median = effect_median), by = "CU") %>%
left_join(effect_sizes_cu_df(ric_chm_cpd_ocean_covariates_logR, effect = "npgo", species = "chum") %>%
rename(npgo_effect_median = effect_median), by = "CU")
write.csv(effect_chum_cpd_sst_npgo,
here("tables","manuscript_nov2025_chum_ricker_cpd_sst_npgo_effect_sizes_by_cu_table.csv"),
row.names = FALSE)
effect_sizes_river_df <- function(posterior, effect, species){
if(species == "chum"){
df <- ch20rsc
} else if(species == "pink"){
df <- pk10r
}
effect_df <- NULL
for (i in 1:length(unique(df$River_n))){
river <- unique(df$River_n)[i]
river_data <- df %>% filter(River_n == river)
if(effect == "cpd"){
b_rv <- posterior %>% select(starts_with("b_for_rv")) %>%
select(ends_with(paste0("[",rv,"]")))
} else if(effect == "sst"){
b_rv <- posterior %>% select(starts_with("b_sst_rv")) %>%
select(ends_with(paste0("[",rv,"]")))
} else if(effect == "npgo"){
b_rv <- posterior %>% select(starts_with("b_npgo_rv")) %>%
select(ends_with(paste0("[",rv,"]")))
}
effect_df_rv <- data.frame(River = unique(river_data$River),
effect_median = round(apply(as.matrix(b_rv[,1]),2,median),2))
# sym(effect)_25 = apply(as.matrix(b_cu[,1]),2,quantile, probs = 0.25),
# sym(effect)_75 = apply(as.matrix(b_cu[,1]),2,quantile, probs = 0.75),
# sym(effect)_025 = apply(as.matrix(b_cu[,1]),2,quantile, probs = 0.025),
# sym(effect)_975 = apply(as.matrix(b_cu[,1]),2,quantile, probs = 0.975))
effect_df <- rbind(effect_df, effect_df_rv)
}
return(effect_df)
}
effect_chum_cpd_sst_npgo_rv <- effect_sizes_river_df(ric_chm_cpd_ocean_covariates_logR, effect = "cpd", species = "chum") %>%
rename(cpd_effect_median = effect_median) %>%
left_join(effect_sizes_cu_df(ric_chm_cpd_ocean_covariates_logR, effect = "sst", species = "chum") %>%
rename(sst_effect_median = effect_median), by = "River") %>%
left_join(effect_sizes_cu_df(ric_chm_cpd_ocean_covariates_logR, effect = "npgo", species = "chum") %>%
rename(npgo_effect_median = effect_median), by = "River")
i
river <- unique(df$River_n)[i]
river_data <- df %>% filter(River_n == river)
View(river_data)
posterior %>% select(starts_with("b_for_rv")) %>%
select(ends_with(paste0("[",rv,"]")))
posterior %>% select(starts_with("b_for_rv"))
effect_sizes_river_df <- function(posterior, effect, species){
if(species == "chum"){
df <- ch20rsc
} else if(species == "pink"){
df <- pk10r
}
effect_df <- NULL
for (i in 1:length(unique(df$River_n))){
river <- unique(df$River_n)[i]
river_data <- df %>% filter(River_n == river)
if(effect == "cpd"){
b_rv <- posterior %>% select(starts_with("b_for_rv")) %>%
select(ends_with(paste0("[",river,"]")))
} else if(effect == "sst"){
b_rv <- posterior %>% select(starts_with("b_sst_rv")) %>%
select(ends_with(paste0("[",river,"]")))
} else if(effect == "npgo"){
b_rv <- posterior %>% select(starts_with("b_npgo_rv")) %>%
select(ends_with(paste0("[",river,"]")))
}
effect_df_rv <- data.frame(River = unique(river_data$River),
effect_median = round(apply(as.matrix(b_rv[,1]),2,median),2))
# sym(effect)_25 = apply(as.matrix(b_cu[,1]),2,quantile, probs = 0.25),
# sym(effect)_75 = apply(as.matrix(b_cu[,1]),2,quantile, probs = 0.75),
# sym(effect)_025 = apply(as.matrix(b_cu[,1]),2,quantile, probs = 0.025),
# sym(effect)_975 = apply(as.matrix(b_cu[,1]),2,quantile, probs = 0.975))
effect_df <- rbind(effect_df, effect_df_rv)
}
return(effect_df)
}
effect_chum_cpd_sst_npgo_rv <- effect_sizes_river_df(ric_chm_cpd_ocean_covariates_logR, effect = "cpd", species = "chum") %>%
rename(cpd_effect_median = effect_median) %>%
left_join(effect_sizes_cu_df(ric_chm_cpd_ocean_covariates_logR, effect = "sst", species = "chum") %>%
rename(sst_effect_median = effect_median), by = "River") %>%
left_join(effect_sizes_cu_df(ric_chm_cpd_ocean_covariates_logR, effect = "npgo", species = "chum") %>%
rename(npgo_effect_median = effect_median), by = "River")
effect_sizes_river_df(ric_chm_cpd_ocean_covariates_logR, effect = "cpd", species = "chum") %>%
rename(cpd_effect_median = effect_median)
effect_sizes_river_df(ric_chm_cpd_ocean_covariates_logR, effect = "cpd", species = "chum") %>%
rename(cpd_effect_median = effect_median) %>%
left_join(effect_sizes_cu_df(ric_chm_cpd_ocean_covariates_logR, effect = "sst", species = "chum") %>%
rename(sst_effect_median = effect_median), by = "River")
effect_chum_cpd_sst_npgo_rv <- effect_sizes_river_df(ric_chm_cpd_ocean_covariates_logR, effect = "cpd", species = "chum") %>%
rename(cpd_effect_median = effect_median) %>%
left_join(effect_sizes_river_df(ric_chm_cpd_ocean_covariates_logR, effect = "sst", species = "chum") %>%
rename(sst_effect_median = effect_median), by = "River") %>%
left_join(effect_sizes_river_df(ric_chm_cpd_ocean_covariates_logR, effect = "npgo", species = "chum") %>%
rename(npgo_effect_median = effect_median), by = "River")
View(effect_chum_cpd_sst_npgo_rv)
sum(which(abs(effect_chum_cpd_sst_npgo_rv$cpd_effect_median)>abs(effect_chum_cpd_sst_npgo_rv$sst_effect_median)))
which(abs(effect_chum_cpd_sst_npgo_rv$cpd_effect_median)>abs(effect_chum_cpd_sst_npgo_rv$sst_effect_median))
sum((abs(effect_chum_cpd_sst_npgo_rv$cpd_effect_median)>abs(effect_chum_cpd_sst_npgo_rv$sst_effect_median)))
abs(effect_chum_cpd_sst_npgo_rv$cpd_effect_median)>abs(effect_chum_cpd_sst_npgo_rv$sst_effect_median))
(abs(effect_chum_cpd_sst_npgo_rv$cpd_effect_median)>abs(effect_chum_cpd_sst_npgo_rv$sst_effect_median))
sum((abs(effect_chum_cpd_sst_npgo_rv$cpd_effect_median)>abs(effect_chum_cpd_sst_npgo_rv$sst_effect_median))&
(abs(effect_chum_cpd_sst_npgo_rv$cpd_effect_median)>abs(effect_chum_cpd_sst_npgo_rv$npgo_effect_median)))
227/374
median(posterior %>% select(starts_with("b_for")))
posterior %>% select(starts_with("b_for"))
posterior %>% select("b_for")
median(posterior %>% select("b_for"))
median(posterior %>% select("b_for"),1)
median(posterior$b_for)
median(posterior$b_sst)
median(posterior$b_npgo)
median(posterior$b_for)/median(posterior$b_sst)
median(posterior$b_for)/median(posterior$b_npgo)
posterior2 <- ric_chm_eca_ocean_covariates_logR
median(posterior2$b_for)/median(posterior2$b_npgo)
median(posterior2$b_for)/median(posterior2$b_sst)
library(here)
library(bayesplot)
posterior <- read.csv(here("stan models","outs","posterior","ric_chm_cpd_ocean_covariates_logR.csv"))
mcmc_pairs(
posterior,
pars = c("b_for","b_npgo","b_sst"),
off_diag_args = list(size = 0.5, alpha = 0.5)
)
mcmc_pairs(
posterior,
pars = c("b_for","b_npgo","b_sst"),
off_diag_args = list(size = 1, alpha = 0.1)
)
mcmc_pairs(
posterior,
pars = c("b_for_cu\\[[1,4]\\]","b_npgo\\[[1,4]\\]","b_sst\\[[1,4]\\]"),
off_diag_args = list(size = 1, alpha = 0.1)
)
print("b_sst\\[[1,4]\\]")
mcmc_pairs(
posterior,
regex_pars = c("b_for_cu\\[[1,4]\\]","b_npgo\\[[1,4]\\]","b_sst\\[[1,4]\\]"),
off_diag_args = list(size = 1, alpha = 0.1)
)
mcmc_pairs(
posterior,
regex_pars = c("b_for_cu\\[[1,4]\\]","b_npgo_cu\\[[1,4]\\]","b_sst_cu\\[[1,4]\\]"),
off_diag_args = list(size = 1, alpha = 0.1)
)
mcmc_pairs(
posterior,
regex_pars = c("b_for_cu\\[[1,4]\\]"),
off_diag_args = list(size = 1, alpha = 0.1)
)
mcmc_pairs(
posterior,
# regex_pars = c("b_for_cu\\[[1,4]\\]","b_npgo_cu\\[[1,4]\\]","b_sst_cu\\[[1,4]\\]"),
regex_pars = c("b_for_cu\\[1\\]","b_npgo_cu\\[1\\]","b_sst_cu\\[1\\]"),
off_diag_args = list(size = 1, alpha = 0.1)
)
mcmc_pairs(
posterior,
pars = c("b_for_cu[1]","b_npgo_cu[1]","b_sst_cu[1]")
off_diag_args = list(size = 1, alpha = 0.1)
mcmc_pairs(
posterior,
pars = c("b_for_cu[1]","b_npgo_cu[1]","b_sst_cu[1]"),
off_diag_args = list(size = 1, alpha = 0.1)
)
View(posterior)
mcmc_pairs(
posterior,
pars = c("b_for_cu.1.","b_npgo_cu.1.","b_sst_cu.1."),
off_diag_args = list(size = 1, alpha = 0.1)
)
mcmc_pairs(
posterior,
regex_pars = c("b_for_cu.[2,4].","b_npgo_cu.[2,4].","b_sst_cu.[2,4]."),
off_diag_args = list(size = 1, alpha = 0.1)
)
knitr::opts_chunk$set(warning = FALSE, echo = FALSE)
knitr::opts_chunk$set(warning = FALSE)
knitr::opts_chunk$set(cache=FALSE)
options(max.print=23)
library(cmdstanr)
library(here);library(dplyr); library(stringr)
library(ggplot2)
library(tidyverse)
library(bayesplot)
library(patchwork)
library(hues)
library(GGally)
library(latex2exp)
library(ggforce)
num_cu <- 24
for(i in 1:num_cu){
cu_name <- unique(ch20rsc$CU)[i]
b_for_name <- paste0("b_for_cu.", i, ".")
b_sst_name <- paste0("b_sst_cu.", i, ".")
b_npgo_name <- paste0("b_npgo_cu.", i, ".")
posterior_cu <- posterior %>%
select(all_of(c(b_for_name, b_sst_name, b_npgo_name)))
colnames(posterior_cu) <- c("b_for", "b_sst", "b_npgo")
p <- mcmc_pairs(
posterior_cu,
diag_fun = "dens",
off_diag_fun = "hex",
npcs = 3
) +
ggtitle(paste("CU:", cu_name))
print(p)
}
for(i in 1:num_cu){
cu_name <- unique(ch20rsc$CU)[i]
b_for_name <- paste0("b_for_cu.", i, ".")
b_sst_name <- paste0("b_sst_cu.", i, ".")
b_npgo_name <- paste0("b_npgo_cu.", i, ".")
posterior_cu <- posterior %>%
select(all_of(c(b_for_name, b_sst_name, b_npgo_name)))
colnames(posterior_cu) <- c("b_for", "b_sst", "b_npgo")
p <- mcmc_pairs(
posterior_cu,
off_diag_args = list(size = 1, alpha = 0.1)
) +
ggtitle(paste("CU:", cu_name))
print(p)
}
for(i in 1:num_cu){
cu_name <- unique(ch20rsc$CU)[i]
b_for_name <- paste0("b_for_cu.", i, ".")
b_sst_name <- paste0("b_sst_cu.", i, ".")
b_npgo_name <- paste0("b_npgo_cu.", i, ".")
posterior_cu <- posterior %>%
select(all_of(c(b_for_name, b_sst_name, b_npgo_name)))
colnames(posterior_cu) <- c("b_for", "b_sst", "b_npgo")
p <- mcmc_pairs(
posterior_cu,
pars = c("b_for", "b_sst", "b_npgo"),
off_diag_args = list(size = 1, alpha = 0.1)
) +
ggtitle(paste("CU:", cu_name))
print(p)
}
for(i in 1:num_cu){
cu_name <- unique(ch20rsc$CU)[i]
b_for_name <- paste0("b_for_cu.", i, ".")
b_sst_name <- paste0("b_sst_cu.", i, ".")
b_npgo_name <- paste0("b_npgo_cu.", i, ".")
posterior_cu <- posterior %>%
select(all_of(c(b_for_name, b_sst_name, b_npgo_name)))
colnames(posterior_cu) <- c("b_for", "b_sst", "b_npgo")
mcmc_pairs(
posterior_cu,
pars = c("b_for", "b_sst", "b_npgo"),
off_diag_args = list(size = 1, alpha = 0.1)
)
}
# for each cu make mcmc_pairs plot of b_for_cu.1., b_sst_cu.1., b_cpgo_cu.1
num_cu <- 24
for(i in 1:num_cu){
cu_name <- unique(ch20rsc$CU)[i]
b_for_name <- paste0("b_for_cu.", i, ".")
b_sst_name <- paste0("b_sst_cu.", i, ".")
b_npgo_name <- paste0("b_npgo_cu.", i, ".")
posterior_cu <- posterior %>%
select(all_of(c(b_for_name, b_sst_name, b_npgo_name)))
colnames(posterior_cu) <- c("b_for", "b_sst", "b_npgo")
print(mcmc_pairs(
posterior_cu,
pars = c("b_for", "b_sst", "b_npgo"),
off_diag_args = list(size = 1, alpha = 0.1)
))
}
mcmc_pairs(
posterior_cu,
pars = c("b_for", "b_sst", "b_npgo"),
off_diag_args = list(size = 1, alpha = 0.1)
)+ggtitle(cu_name)
mcmc_pairs(
posterior_cu,
pars = c("b_for", "b_sst", "b_npgo"),
off_diag_args = list(size = 1, alpha = 0.1)
)+labs(title = cu_name)
unique(ch20rsc$CU)
unique(ch20rsc$CU_name)[i]
unique(ch20rsc$CU_name)
length(unique(ch20rsc$CU_name))
# for each cu make mcmc_pairs plot of b_for_cu.1., b_sst_cu.1., b_cpgo_cu.1
num_cu <- length(unique(ch20rsc$CU_name))
for(i in 1:num_cu){
cu_name <- unique(ch20rsc$CU_name)[i]
b_for_name <- paste0("b_for_cu.", i, ".")
b_sst_name <- paste0("b_sst_cu.", i, ".")
b_npgo_name <- paste0("b_npgo_cu.", i, ".")
posterior_cu <- posterior %>%
select(all_of(c(b_for_name, b_sst_name, b_npgo_name)))
colnames(posterior_cu) <- c("b_for", "b_sst", "b_npgo")
print(mcmc_pairs(
posterior_cu,
pars = c("b_for", "b_sst", "b_npgo"),
off_diag_args = list(size = 1, alpha = 0.1),
grid_args = list(top = cu_name)
))
}
View(effect_chum_cpd_sst_npgo_rv)
