aes(fill = CPD), color = "gray90", linewidth = 0.2)  +
geom_sf(data = md_territory, fill = "transparent", color = "darkred", linewidth = 0.8) +
#label watersheds with River
#arrow to the watershed
geom_sf_label_repel(data = pop_sheds2, aes(label = River),
size = 3, color = "black", alpha = 0.7,
# family = "ArcherPro Book",
hjust = 0.5, label.padding = unit(0.15, "lines"),
min.segment.length = 0,
xlim = c(st_bbox(md_territory)$xmax,NA))+
# nudge_x = 70000, nudge_y = -20000) +
#
# # Plot Window
coord_sf(crs = st_crs(pop_sheds2),
xlim = c(b["xmin"]-100000, b["xmax"]+100000 ) ,
ylim = c(b["ymin"]-150000 , b["ymax"]+100000)) +
# scale_color_manual("MD territory", values = "darkred") +
scale_fill_gradient2(name = 'CPD', guide = guide_colorbar(ticks = FALSE, barheight = 5),
low = '#35978f', mid = 'gray', high = '#bf812d', midpoint = 0.5) +
# scale_color_gradient2(name = 'CPD',
#                       low = '#35978f', mid = 'gray', high = '#bf812d', midpoint = 50) +
theme(panel.grid.major = element_line(colour = "aliceblue", linetype = "dashed",
size = 0.5),
panel.background = element_rect(fill = "aliceblue"),
panel.border = element_rect(fill = NA, color = NA),
axis.text = element_blank(),
axis.ticks = element_blank(),
base_family = "ArcherPro Book",
legend.position = c(0.95, 0.5),
# legend.title = element_blank(),
legend.text = element_text(size = 10),
legend.font = "ArcherPro Book",
legend.key.size = unit(0.8, "cm"),
legend.key.spacing.y = unit(0.5, "cm"),
legend.key.width = unit(0.5, "cm"),
legend.key.height = unit(0.5, "cm"),
legend.background = element_rect(fill = "transparent", size = 0.5)
) +
labs(x = "", y = "", color = "", fill = "") +
# Spatial annotation
ggspatial::annotation_scale(
location = "bl",
bar_cols = c("black", "white"),
text_family = "ArcherPro Book"
) +
ggspatial::annotation_north_arrow(
location = "tr", which_north = "true",
# pad_x = unit(0.4, "in"), pad_y = unit(0.4, "in"),
style = ggspatial::north_arrow_nautical(
fill = c("black", "white"),
line_col = "black",
text_family = "ArcherPro Book"
)
)  +
# inset_element(wld_map, left = 0.05, bottom = 0.1, right = 0.3, top = 0.35, align_to = "plot")
inset_element(canada, left = 0.05, bottom = 0.05, right = 0.45, top = 0.45, align_to = "plot")
ggplot() +
geom_sf(data = bc_boundary, fill = "gray90", color = alpha("slategray",0.1), linewidth = 0.5) +
# geom_sf(data = Canada, fill = "grey90", color = NA) +
# geom_sf(data = USA, fill = "grey90", color = NA) +
# Regional colors layer
geom_sf(data = pop_sheds2,
aes(fill = CPD), color = "gray90", linewidth = 0.2)  +
geom_sf(data = md_territory, fill = "transparent", color = "darkred", linewidth = 0.8) +
#label watersheds with River
#arrow to the watershed
geom_sf_label_repel(data = pop_sheds2, aes(label = River),
size = 3, color = "black", alpha = 0.7,
# family = "ArcherPro Book",
hjust = 0.5, label.padding = unit(0.15, "lines"),
min.segment.length = 0,
xlim = c(st_bbox(md_territory)$xmax,NA))+
# nudge_x = 70000, nudge_y = -20000) +
#
# # Plot Window
coord_sf(crs = st_crs(pop_sheds2),
xlim = c(b["xmin"]-100000, b["xmax"]+100000 ) ,
ylim = c(b["ymin"]-150000 , b["ymax"]+100000)) +
# scale_color_manual("MD territory", values = "darkred") +
scale_fill_gradient2(name = 'CPD', guide = guide_colorbar(ticks = FALSE, barheight = 5),
low = '#35978f', mid = 'gray', high = '#bf812d', midpoint = 0.5) +
# scale_color_gradient2(name = 'CPD',
#                       low = '#35978f', mid = 'gray', high = '#bf812d', midpoint = 50) +
theme(panel.grid.major = element_line(colour = "aliceblue", linetype = "dashed",
size = 0.5),
panel.background = element_rect(fill = "aliceblue"),
panel.border = element_rect(fill = NA, color = NA),
axis.text = element_blank(),
axis.ticks = element_blank(),
base_family = "ArcherPro Book",
legend.position = c(0.95, 0.5),
# legend.title = element_blank(),
legend.text = element_text(size = 10),
legend.font = "ArcherPro Book",
legend.key.size = unit(0.8, "cm"),
legend.key.spacing.y = unit(0.5, "cm"),
legend.key.width = unit(0.5, "cm"),
legend.key.height = unit(0.5, "cm"),
legend.background = element_rect(fill = "transparent", size = 0.5)
) +
labs(x = "", y = "", color = "", fill = "") +
# Spatial annotation
ggspatial::annotation_scale(
location = "bl",
bar_cols = c("black", "white"),
text_family = "ArcherPro Book"
) +
ggspatial::annotation_north_arrow(
location = "tr", which_north = "true",
# pad_x = unit(0.4, "in"), pad_y = unit(0.4, "in"),
style = ggspatial::north_arrow_nautical(
fill = c("black", "white"),
line_col = "black",
text_family = "ArcherPro Book"
)
)  +
# inset_element(wld_map, left = 0.05, bottom = 0.1, right = 0.3, top = 0.35, align_to = "plot")
inset_element(canada, left = 0.0, bottom = 0.0, right = 0.45, top = 0.45, align_to = "plot")
ggplot() +
geom_sf(data = bc_boundary, fill = "gray90", color = alpha("slategray",0.1), linewidth = 0.5) +
# geom_sf(data = Canada, fill = "grey90", color = NA) +
# geom_sf(data = USA, fill = "grey90", color = NA) +
# Regional colors layer
geom_sf(data = pop_sheds2,
aes(fill = CPD), color = "gray90", linewidth = 0.2)  +
geom_sf(data = md_territory, fill = "transparent", color = "darkred", linewidth = 0.8) +
#label watersheds with River
#arrow to the watershed
geom_sf_label_repel(data = pop_sheds2, aes(label = River),
size = 3, color = "black", alpha = 0.7,
# family = "ArcherPro Book",
hjust = 0.5, label.padding = unit(0.15, "lines"),
min.segment.length = 0,
xlim = c(st_bbox(md_territory)$xmax,NA))+
# nudge_x = 70000, nudge_y = -20000) +
#
# # Plot Window
coord_sf(crs = st_crs(pop_sheds2),
xlim = c(b["xmin"]-100000, b["xmax"]+100000 ) ,
ylim = c(b["ymin"]-150000 , b["ymax"]+100000)) +
# scale_color_manual("MD territory", values = "darkred") +
scale_fill_gradient2(name = 'CPD', guide = guide_colorbar(ticks = FALSE, barheight = 5),
low = '#35978f', mid = 'gray', high = '#bf812d', midpoint = 0.5) +
# scale_color_gradient2(name = 'CPD',
#                       low = '#35978f', mid = 'gray', high = '#bf812d', midpoint = 50) +
theme(panel.grid.major = element_line(colour = "aliceblue", linetype = "dashed",
size = 0.5),
panel.background = element_rect(fill = "aliceblue"),
panel.border = element_rect(fill = NA, color = NA),
axis.text = element_blank(),
axis.ticks = element_blank(),
base_family = "ArcherPro Book",
legend.position = c(0.95, 0.5),
# legend.title = element_blank(),
legend.text = element_text(size = 10),
legend.font = "ArcherPro Book",
legend.key.size = unit(0.8, "cm"),
legend.key.spacing.y = unit(0.5, "cm"),
legend.key.width = unit(0.5, "cm"),
legend.key.height = unit(0.5, "cm"),
legend.background = element_rect(fill = "transparent", size = 0.5)
) +
labs(x = "", y = "", color = "", fill = "") +
# Spatial annotation
ggspatial::annotation_scale(
location = "bl",
bar_cols = c("black", "white"),
text_family = "ArcherPro Book"
) +
ggspatial::annotation_north_arrow(
location = "tr", which_north = "true",
# pad_x = unit(0.4, "in"), pad_y = unit(0.4, "in"),
style = ggspatial::north_arrow_nautical(
fill = c("black", "white"),
line_col = "black",
text_family = "ArcherPro Book"
)
)  +
# inset_element(wld_map, left = 0.05, bottom = 0.1, right = 0.3, top = 0.35, align_to = "plot")
inset_element(bc_boundary, left = 0.0, bottom = 0.0, right = 0.45, top = 0.45, align_to = "plot")
ggplot() +
geom_sf(data = bc_boundary, fill = "gray90", color = alpha("slategray",0.1), linewidth = 0.5) +
# geom_sf(data = Canada, fill = "grey90", color = NA) +
# geom_sf(data = USA, fill = "grey90", color = NA) +
# Regional colors layer
geom_sf(data = pop_sheds2,
aes(fill = CPD), color = "gray90", linewidth = 0.2)  +
geom_sf(data = md_territory, fill = "transparent", color = "darkred", linewidth = 0.8) +
#label watersheds with River
#arrow to the watershed
geom_sf_label_repel(data = pop_sheds2, aes(label = River),
size = 3, color = "black", alpha = 0.7,
# family = "ArcherPro Book",
hjust = 0.5, label.padding = unit(0.15, "lines"),
min.segment.length = 0,
xlim = c(st_bbox(md_territory)$xmax,NA))+
# nudge_x = 70000, nudge_y = -20000) +
#
# # Plot Window
coord_sf(crs = st_crs(pop_sheds2),
xlim = c(b["xmin"]-100000, b["xmax"]+100000 ) ,
ylim = c(b["ymin"]-150000 , b["ymax"]+100000)) +
# scale_color_manual("MD territory", values = "darkred") +
scale_fill_gradient2(name = 'CPD', guide = guide_colorbar(ticks = FALSE, barheight = 5),
low = '#35978f', mid = 'gray', high = '#bf812d', midpoint = 0.5) +
# scale_color_gradient2(name = 'CPD',
#                       low = '#35978f', mid = 'gray', high = '#bf812d', midpoint = 50) +
theme(panel.grid.major = element_line(colour = "aliceblue", linetype = "dashed",
size = 0.5),
panel.background = element_rect(fill = "aliceblue"),
panel.border = element_rect(fill = NA, color = NA),
axis.text = element_blank(),
axis.ticks = element_blank(),
base_family = "ArcherPro Book",
legend.position = c(0.95, 0.5),
# legend.title = element_blank(),
legend.text = element_text(size = 10),
legend.font = "ArcherPro Book",
legend.key.size = unit(0.8, "cm"),
legend.key.spacing.y = unit(0.5, "cm"),
legend.key.width = unit(0.5, "cm"),
legend.key.height = unit(0.5, "cm"),
legend.background = element_rect(fill = "transparent", size = 0.5)
) +
labs(x = "", y = "", color = "", fill = "") +
# Spatial annotation
ggspatial::annotation_scale(
location = "bl",
bar_cols = c("black", "white"),
text_family = "ArcherPro Book"
) +
ggspatial::annotation_north_arrow(
location = "tr", which_north = "true",
# pad_x = unit(0.4, "in"), pad_y = unit(0.4, "in"),
style = ggspatial::north_arrow_nautical(
fill = c("black", "white"),
line_col = "black",
text_family = "ArcherPro Book"
)
)  +
# inset_element(wld_map, left = 0.05, bottom = 0.1, right = 0.3, top = 0.35, align_to = "plot")
inset_element(bc, left = 0.0, bottom = 0.0, right = 0.45, top = 0.45, align_to = "plot")
ggplot() +
geom_sf(data = bc_boundary, fill = "gray90", color = alpha("slategray",0.1), linewidth = 0.5) +
# geom_sf(data = Canada, fill = "grey90", color = NA) +
# geom_sf(data = USA, fill = "grey90", color = NA) +
# Regional colors layer
geom_sf(data = pop_sheds2,
aes(fill = CPD), color = "gray90", linewidth = 0.2)  +
geom_sf(data = md_territory, fill = "transparent", color = "darkred", linewidth = 0.8) +
#label watersheds with River
#arrow to the watershed
geom_sf_label_repel(data = pop_sheds2, aes(label = River),
size = 3, color = "black", alpha = 0.7,
# family = "ArcherPro Book",
hjust = 0.5, label.padding = unit(0.15, "lines"),
min.segment.length = 0,
xlim = c(st_bbox(md_territory)$xmax,NA))+
# nudge_x = 70000, nudge_y = -20000) +
#
# # Plot Window
coord_sf(crs = st_crs(pop_sheds2),
xlim = c(b["xmin"]-100000, b["xmax"]+100000 ) ,
ylim = c(b["ymin"]-150000 , b["ymax"]+100000)) +
# scale_color_manual("MD territory", values = "darkred") +
scale_fill_gradient2(name = 'CPD', guide = guide_colorbar(ticks = FALSE, barheight = 5),
low = '#35978f', mid = 'gray', high = '#bf812d', midpoint = 0.5) +
# scale_color_gradient2(name = 'CPD',
#                       low = '#35978f', mid = 'gray', high = '#bf812d', midpoint = 50) +
theme(panel.grid.major = element_line(colour = "aliceblue", linetype = "dashed",
size = 0.5),
panel.background = element_rect(fill = "aliceblue"),
panel.border = element_rect(fill = NA, color = NA),
axis.text = element_blank(),
axis.ticks = element_blank(),
base_family = "ArcherPro Book",
legend.position = c(0.95, 0.5),
# legend.title = element_blank(),
legend.text = element_text(size = 10),
legend.font = "ArcherPro Book",
legend.key.size = unit(0.8, "cm"),
legend.key.spacing.y = unit(0.5, "cm"),
legend.key.width = unit(0.5, "cm"),
legend.key.height = unit(0.5, "cm"),
legend.background = element_rect(fill = "transparent", size = 0.5)
) +
labs(x = "", y = "", color = "", fill = "") +
# Spatial annotation
ggspatial::annotation_scale(
location = "bl",
bar_cols = c("black", "white"),
text_family = "ArcherPro Book"
) +
ggspatial::annotation_north_arrow(
location = "tr", which_north = "true",
# pad_x = unit(0.4, "in"), pad_y = unit(0.4, "in"),
style = ggspatial::north_arrow_nautical(
fill = c("black", "white"),
line_col = "black",
text_family = "ArcherPro Book"
)
)  +
# inset_element(wld_map, left = 0.05, bottom = 0.1, right = 0.3, top = 0.35, align_to = "plot")
inset_element(bc_boundary, left = 0.0, bottom = 0.0, right = 0.45, top = 0.45, align_to = "plot")
ggplot() +
geom_sf(data = bc_boundary, fill = "gray90", color = alpha("slategray",0.1), linewidth = 0.5) +
# geom_sf(data = Canada, fill = "grey90", color = NA) +
# geom_sf(data = USA, fill = "grey90", color = NA) +
# Regional colors layer
geom_sf(data = pop_sheds2,
aes(fill = CPD), color = "gray90", linewidth = 0.2)  +
geom_sf(data = md_territory, fill = "transparent", color = "darkred", linewidth = 0.8) +
#label watersheds with River
#arrow to the watershed
geom_sf_label_repel(data = pop_sheds2, aes(label = River),
size = 3, color = "black", alpha = 0.7,
# family = "ArcherPro Book",
hjust = 0.5, label.padding = unit(0.15, "lines"),
min.segment.length = 0,
xlim = c(st_bbox(md_territory)$xmax,NA))+
# nudge_x = 70000, nudge_y = -20000) +
#
# # Plot Window
coord_sf(crs = st_crs(pop_sheds2),
xlim = c(b["xmin"]-100000, b["xmax"]+100000 ) ,
ylim = c(b["ymin"]-150000 , b["ymax"]+100000)) +
# scale_color_manual("MD territory", values = "darkred") +
scale_fill_gradient2(name = 'CPD', guide = guide_colorbar(ticks = FALSE, barheight = 5),
low = '#35978f', mid = 'gray', high = '#bf812d', midpoint = 0.5) +
# scale_color_gradient2(name = 'CPD',
#                       low = '#35978f', mid = 'gray', high = '#bf812d', midpoint = 50) +
theme(panel.grid.major = element_line(colour = "aliceblue", linetype = "dashed",
size = 0.5),
panel.background = element_rect(fill = "aliceblue"),
panel.border = element_rect(fill = NA, color = NA),
axis.text = element_blank(),
axis.ticks = element_blank(),
base_family = "ArcherPro Book",
legend.position = c(0.95, 0.5),
# legend.title = element_blank(),
legend.text = element_text(size = 10),
legend.font = "ArcherPro Book",
legend.key.size = unit(0.8, "cm"),
legend.key.spacing.y = unit(0.5, "cm"),
legend.key.width = unit(0.5, "cm"),
legend.key.height = unit(0.5, "cm"),
legend.background = element_rect(fill = "transparent", size = 0.5)
) +
labs(x = "", y = "", color = "", fill = "") +
# Spatial annotation
ggspatial::annotation_scale(
location = "bl",
bar_cols = c("black", "white"),
text_family = "ArcherPro Book"
) +
ggspatial::annotation_north_arrow(
location = "tr", which_north = "true",
# pad_x = unit(0.4, "in"), pad_y = unit(0.4, "in"),
style = ggspatial::north_arrow_nautical(
fill = c("black", "white"),
line_col = "black",
text_family = "ArcherPro Book"
)
)  +
inset_element(wld_map, left = 0.05, bottom = 0.1, right = 0.3, top = 0.35, align_to = "plot")
ggplot() +
geom_sf(data = bc_boundary, fill = "gray90", color = alpha("slategray",0.1), linewidth = 0.5) +
# geom_sf(data = Canada, fill = "grey90", color = NA) +
# geom_sf(data = USA, fill = "grey90", color = NA) +
# Regional colors layer
geom_sf(data = pop_sheds2,
aes(fill = CPD), color = "gray90", linewidth = 0.2)  +
geom_sf(data = md_territory, fill = "transparent", color = "darkred", linewidth = 0.8) +
#label watersheds with River
#arrow to the watershed
geom_sf_label_repel(data = pop_sheds2, aes(label = River),
size = 3, color = "black", alpha = 0.7,
# family = "ArcherPro Book",
hjust = 0.5, label.padding = unit(0.15, "lines"),
min.segment.length = 0,
xlim = c(st_bbox(md_territory)$xmax,NA))+
# nudge_x = 70000, nudge_y = -20000) +
#
# # Plot Window
coord_sf(crs = st_crs(pop_sheds2),
xlim = c(b["xmin"]-100000, b["xmax"]+100000 ) ,
ylim = c(b["ymin"]-150000 , b["ymax"]+100000)) +
# scale_color_manual("MD territory", values = "darkred") +
scale_fill_gradient2(name = 'CPD', guide = guide_colorbar(ticks = FALSE, barheight = 5),
low = '#35978f', mid = 'gray', high = '#bf812d', midpoint = 0.5) +
# scale_color_gradient2(name = 'CPD',
#                       low = '#35978f', mid = 'gray', high = '#bf812d', midpoint = 50) +
theme(panel.grid.major = element_line(colour = "aliceblue", linetype = "dashed",
size = 0.5),
panel.background = element_rect(fill = "aliceblue"),
panel.border = element_rect(fill = NA, color = NA),
axis.text = element_blank(),
axis.ticks = element_blank(),
base_family = "ArcherPro Book",
legend.position = c(0.95, 0.5),
# legend.title = element_blank(),
legend.text = element_text(size = 10),
legend.font = "ArcherPro Book",
legend.key.size = unit(0.8, "cm"),
legend.key.spacing.y = unit(0.5, "cm"),
legend.key.width = unit(0.5, "cm"),
legend.key.height = unit(0.5, "cm"),
legend.background = element_rect(fill = "transparent", size = 0.5)
) +
labs(x = "", y = "", color = "", fill = "") +
# Spatial annotation
ggspatial::annotation_scale(
location = "bl",
bar_cols = c("black", "white"),
text_family = "ArcherPro Book"
) +
ggspatial::annotation_north_arrow(
location = "tr", which_north = "true",
# pad_x = unit(0.4, "in"), pad_y = unit(0.4, "in"),
style = ggspatial::north_arrow_nautical(
fill = c("black", "white"),
line_col = "black",
text_family = "ArcherPro Book"
)
)
# Load the sf package
library(sf)
# Path to the GDB file
gdb_path <- here("origional-ecofish-data-models","Data","Spatial","mdfg_results.gdb")
# List all layers in the GDB
layers <- st_layers(gdb_path)
# print(layers)
# Forestry history (not a spatial dataset)
coast_forestry_timeseries <- st_read(gdb_path, layer = "CPD_ECA_salmon_watersheds_coastwide")
# Coastal salmon watersheds (spatial dataset)
coast_watersheds <- st_read(gdb_path, layer = "salmon_watersheds_coastwide")
mdfg_watersheds <- st_read(gdb_path, layer = "salmon_watersheds_MDFG")
mdfg_forestry_timeseries <- st_read(gdb_path, layer = "CPD_ECA_salmon_watersheds_MDFG")(gdb_path, layer = "CPD_ECA_salmon_watersheds_MDFG")
# Load the sf package
library(sf)
# Path to the GDB file
gdb_path <- here("origional-ecofish-data-models","Data","Spatial","mdfg_results.gdb")
# List all layers in the GDB
layers <- st_layers(gdb_path)
# print(layers)
# Forestry history (not a spatial dataset)
coast_forestry_timeseries <- st_read(gdb_path, layer = "CPD_ECA_salmon_watersheds_coastwide")
# Coastal salmon watersheds (spatial dataset)
coast_watersheds <- st_read(gdb_path, layer = "salmon_watersheds_coastwide")
mdfg_watersheds <- st_read(gdb_path, layer = "salmon_watersheds_MDFG")
mdfg_forestry_timeseries <- st_read(gdb_path, layer = "CPD_ECA_salmon_watersheds_MDFG")
# IF needed, you can join the datasets use the outlet feature id ("outlet_lfid" vector) and watershed group code ("wgc" vector)
# unique(coast_forestry_timeseries$outlet_lfid)
#
# unique(coast_watersheds$outlet_lfid)
# unique(coast_watersheds$wgc)
# unique(mdfg_watersheds$wgc)
coast_forestry_timeseries_geom <- left_join(x = coast_forestry_timeseries,
coast_watersheds %>%
select(outlet_lfid,geom,wgc,NUSEDS_watershed) %>% distinct(),
by = c("outlet_lfid", "wgc"))
# glimpse(coast_watersheds %>% select(geom,wgc,NUSEDS_watershed) %>% distinct())
# glimpse(coast_forestry_timeseries)
# glimpse(coast_forestry_timeseries_geom)
#check which row has KINGCOME RIVER as NUSEDS_watershed
mdfg_forestry_timeseries_geom <- left_join(x = mdfg_forestry_timeseries,
mdfg_watersheds %>%
select(outlet_lfid,geom,wgc,NUSEDS_watershed) %>% distinct(),
by = c("outlet_lfid", "wgc"))
#
# glimpse(mdfg_forestry_timeseries_geom)
posterior1 = ric_chm_cpd_ocean_covariates_logR
river = "CARNATION CREEK"
df <- ch20rsc
river_data <- ch20rsc %>% filter(River == river)
river <- river_data$River_n[1]
river
posterior1 %>%
select(starts_with(paste0('b_for_rv[',as.character(river),']'))) %>%
pivot_longer(cols = everything(),
names_to = 'River',
names_prefix = 'b_for_rv',
values_to = "forestry") %>%
mutate(River_n = as.numeric(str_extract(River, '\\d+'))) %>%
select(-River) %>%
mutate(River = river)
posterior1 %>%
select(starts_with(paste0('b_for_rv[',as.character(river),']')))
posterior1 %>%
select(starts_with(paste0('alpha_j[',as.character(river),']')))
posterior1 %>%
select(starts_with(paste0('alpha_j[',as.character(river),']'))) %>%
pivot_longer(cols = everything(),
names_to = 'River',
names_prefix = 'alpha_j',
values_to = "alpha_j") %>%
mutate(River_n = as.numeric(str_extract(River, '\\d+'))) %>%
select(-River) %>%
mutate(River = river)
posterior1 %>%
select(starts_with(paste0('alpha_j[',as.character(river),']')))
posterior1 %>%
select(starts_with(paste0('Smax[',as.character(river),']')))
posterior1 %>%
select(starts_with(paste0('Smax[',as.character(river),']'))) %>%
pivot_longer(cols = everything(),
names_to = 'River',
names_prefix = 'Smax',
values_to = "Smax") %>%
mutate(River_n = as.numeric(str_extract(River, '\\d+'))) %>%
select(-River) %>%
mutate(River = river)
